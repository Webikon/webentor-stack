import{_ as o,o as a,c as t,ag as i}from"./chunks/framework.Bo7atV7P.js";const h=JSON.parse('{"title":"Monorepo Developer Workflow","description":"","frontmatter":{},"headers":[],"relativePath":"contributing/developer-playbook.md","filePath":"contributing/developer-playbook.md","lastUpdated":1771673321000}'),l={name:"contributing/developer-playbook.md"};function s(r,e,n,c,d,p){return a(),t("div",null,[...e[0]||(e[0]=[i(`<h1 id="monorepo-developer-workflow" tabindex="-1">Monorepo Developer Workflow <a class="header-anchor" href="#monorepo-developer-workflow" aria-label="Permalink to &quot;Monorepo Developer Workflow&quot;">​</a></h1><p>This playbook reflects the current <code>webentor-stack</code> monorepo workflow.</p><h2 id="how-the-stack-is-organized" tabindex="-1">How the stack is organized <a class="header-anchor" href="#how-the-stack-is-organized" aria-label="Permalink to &quot;How the stack is organized&quot;">​</a></h2><p>Work inside one repository with package boundaries:</p><ol><li><code>packages/webentor-core</code> - shared PHP + JS runtime (blocks, images, filters, frontend/editor logic).</li><li><code>packages/webentor-configs</code> - shared lint/format presets.</li><li><code>packages/webentor-setup</code> - shared setup runtime + setup CLI contract.</li><li><code>packages/webentor-starter</code> - starter template composition.</li><li><code>docs</code> - VitePress documentation.</li></ol><p>External context:</p><ul><li><code>webentor-demo</code> remains an external integration target used for final validation.</li></ul><h2 id="daily-workflow-where-to-make-changes" tabindex="-1">Daily workflow (where to make changes) <a class="header-anchor" href="#daily-workflow-where-to-make-changes" aria-label="Permalink to &quot;Daily workflow (where to make changes)&quot;">​</a></h2><p>Use change scope to choose location:</p><ol><li>Shared runtime behavior -&gt; <code>packages/webentor-core</code>.</li><li>Shared lint/format rules -&gt; <code>packages/webentor-configs</code>.</li><li>Setup/bootstrap/upgrade behavior -&gt; <code>packages/webentor-setup</code>.</li><li>Starter defaults and wrapper integration -&gt; <code>packages/webentor-starter</code>.</li><li>Documentation and rollout notes -&gt; <code>docs</code>.</li></ol><p>Rule of thumb: if multiple projects should reuse it, implement it in shared packages, not in project-specific hooks.</p><h2 id="validation-workflow" tabindex="-1">Validation workflow <a class="header-anchor" href="#validation-workflow" aria-label="Permalink to &quot;Validation workflow&quot;">​</a></h2><p>For package-level changes:</p><ol><li>Run package-local checks in the changed package.</li><li>Validate docs/contracts affected by that change.</li><li>Validate integrated behavior through starter/demo flow before release.</li></ol><p>Typical checks:</p><ul><li>Setup/runtime syntax checks in <code>webentor-setup</code>.</li><li>PHP syntax checks for setup CLI and touched PHP files.</li><li>Docs build for documentation changes.</li></ul><h2 id="what-happens-after-push-ci-pipeline" tabindex="-1">What happens after push (CI pipeline) <a class="header-anchor" href="#what-happens-after-push-ci-pipeline" aria-label="Permalink to &quot;What happens after push (CI pipeline)&quot;">​</a></h2><p>Repository automation is split by trigger type so CI stays fast and release steps remain auditable.</p><ul><li><code>.github/workflows/ci.yml</code>: <ul><li>Runs on every pull request and every push to <code>main</code>.</li><li>Uses <code>dorny/paths-filter</code> to execute only jobs for changed areas.</li><li><code>core</code> and <code>configs</code> jobs run lint/build/test.</li><li><code>setup</code> job validates shell scripts and setup CLI PHP syntax.</li><li><code>starter</code> job installs composer dependencies and builds the theme.</li><li><code>docs</code> job builds VitePress docs.</li></ul></li><li><code>.github/workflows/docs-deploy.yml</code>: <ul><li>Runs on push to <code>main</code> when <code>docs/**</code> changed.</li><li>Builds docs and deploys to GitHub Pages.</li></ul></li><li><code>.github/workflows/release.yml</code>: <ul><li>Runs on push to <code>main</code>.</li><li>Uses Changesets action to open/update the &quot;Version Packages&quot; PR.</li><li>After merging that PR, publishes <code>webentor-core</code> and <code>webentor-configs</code> to npm.</li></ul></li><li><code>.github/workflows/demo-bump.yml</code>: <ul><li>Runs after <code>release.yml</code> completes successfully.</li><li>Invokes <code>scripts/bump-demo.sh</code> to trigger downstream demo integration bump flow (placeholder implementation).</li></ul></li><li><code>.github/workflows/split-webentor-core.yml</code>, <code>.github/workflows/split-webentor-setup.yml</code>, and <code>.github/workflows/split-webentor-starter.yml</code>: <ul><li>Run on namespaced monorepo tags (<code>core-v*</code>, <code>setup-v*</code>, <code>starter-v*</code>) or manual dispatch.</li><li>Use subtree split scripts to mirror package contents to standalone repositories.</li><li>Mirror repositories receive normalized semver tags (<code>vX.Y.Z</code>) for downstream package tooling compatibility.</li></ul></li></ul><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushOrPr[&quot;Push_or_PR&quot;] --&gt; ci[&quot;ci.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushMain[&quot;Push_main&quot;] --&gt; release[&quot;release.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  release --&gt; demoBump[&quot;demo-bump.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushMainDocs[&quot;Push_main_with_docs_changes&quot;] --&gt; docsDeploy[&quot;docs-deploy.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushCoreTag[&quot;Push_tag_core-v*&quot;] --&gt; splitCore[&quot;split-webentor-core.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushSetupTag[&quot;Push_tag_setup-v*&quot;] --&gt; splitSetup[&quot;split-webentor-setup.yml&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  pushStarterTag[&quot;Push_tag_starter-v*&quot;] --&gt; splitStarter[&quot;split-webentor-starter.yml&quot;]</span></span></code></pre></div><h2 id="how-to-change-and-release-a-package" tabindex="-1">How to change and release a package <a class="header-anchor" href="#how-to-change-and-release-a-package" aria-label="Permalink to &quot;How to change and release a package&quot;">​</a></h2><p>Use this sequence for package changes so CI, releases, and downstream integration stay synchronized:</p><ol><li>Create a feature branch and implement changes in the relevant <code>packages/*</code> directory.</li><li>Add a changeset: <ol><li>Run <code>pnpm changeset</code>.</li><li>Select affected package(s).</li><li>Select semver bump type.</li><li>Write a short release summary.</li></ol></li><li>Open a pull request; <code>ci.yml</code> validates changed areas.</li><li>Merge the PR into <code>main</code>; <code>release.yml</code> then opens/updates the &quot;Version Packages&quot; PR.</li><li>Merge the version PR; Changesets bumps versions/changelogs and publishes npm packages.</li><li>Confirm <code>demo-bump.yml</code> ran successfully after release.</li><li>Push a namespaced tag when you want to trigger a specific split mirror: <ol><li><code>core-v*</code> -&gt; <code>split-webentor-core.yml</code></li><li><code>setup-v*</code> -&gt; <code>split-webentor-setup.yml</code></li><li><code>starter-v*</code> -&gt; <code>split-webentor-starter.yml</code></li><li>Mirror scripts normalize these to <code>vX.Y.Z</code> tags in target repositories.</li></ol></li></ol><h2 id="release-and-rollout-order" tabindex="-1">Release and rollout order <a class="header-anchor" href="#release-and-rollout-order" aria-label="Permalink to &quot;Release and rollout order&quot;">​</a></h2><p>When changes span multiple packages, keep this order and map each stage to automation:</p><ol><li><code>webentor-core</code> and/or <code>webentor-configs</code><ul><li>Add changesets in PRs.</li><li><code>release.yml</code> + Changesets handles version PR and npm publish after merge.</li></ul></li><li><code>webentor-setup</code> (include upgrade recipe when behavior changes) <ul><li>Validate runtime/CLI contract updates.</li><li>Trigger split mirror via <code>setup-v*</code> tag when ready.</li></ul></li><li><code>webentor-starter</code><ul><li>Validate integrated behavior against updated package outputs.</li><li>Trigger split mirror via <code>starter-v*</code> tag when ready.</li></ul></li><li><code>webentor-core</code> mirror (for standalone Composer delivery) <ul><li>Trigger split mirror via <code>core-v*</code> tag when ready.</li><li>Confirm target mirror tag is normalized to <code>vX.Y.Z</code>.</li></ul></li><li><code>webentor-demo</code> integration validation and bump <ul><li>Validate downstream compatibility after release.</li><li><code>demo-bump.yml</code> is the automation hook for this handoff.</li></ul></li></ol><h2 id="setup-core-contract-do-not-break" tabindex="-1">Setup-core contract (do not break) <a class="header-anchor" href="#setup-core-contract-do-not-break" aria-label="Permalink to &quot;Setup-core contract (do not break)&quot;">​</a></h2><p>In consumer projects:</p><ul><li><code>scripts/setup-core/</code> is synchronized runtime payload from <code>webentor-setup</code>.</li><li>Do not put project business logic in <code>setup-core</code>.</li></ul><p>Project-specific setup customization belongs in:</p><ul><li><code>scripts/.env.setup</code></li><li><code>scripts/hooks/</code></li><li><code>scripts/project-specific/</code></li></ul><h2 id="team-working-agreement" tabindex="-1">Team working agreement <a class="header-anchor" href="#team-working-agreement" aria-label="Permalink to &quot;Team working agreement&quot;">​</a></h2><ol><li>Keep reusable behavior in shared packages, not in ad-hoc project patches.</li><li>Keep setup contract updates synchronized across runtime scripts, CLI behavior, docs, and upgrade manifests.</li><li>Treat demo integration checks as release gate before declaring coordinated changes complete.</li></ol>`,33)])])}const g=o(l,[["render",s]]);export{h as __pageData,g as default};
